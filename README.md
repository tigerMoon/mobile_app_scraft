# Died Or Not Â· AI Fullstack Scaffold

è¿™æ˜¯ä¸€ä¸ª **ä¸º AI ç¼–ç¨‹æ—¶ä»£è®¾è®¡çš„æœ€å°å¯ç”¨å…¨æ ˆ App è„šæ‰‹æ¶**ï¼Œ
åŸºäºçœŸå®æ¡ˆä¾‹ã€Œæ­»äº†ä¹ˆã€APP æŠ½è±¡è€Œæ¥ï¼Œç›®æ ‡æ˜¯ï¼š

> **è®© AI æ›´å®¹æ˜“å†™å¯¹ä»£ç ï¼Œè®©äººç±»æ›´ä¸“æ³¨ä¸šåŠ¡æœ¬èº«ã€‚**

---

## ä¸€ã€æ•´ä½“æ¶æ„

### æŠ€æœ¯é€‰å‹

| å±‚çº§ | æŠ€æœ¯ |
|----|----|
| å‰ç«¯ | SwiftUI (iOS)ã€Jetpack Compose (Android) |
| åç«¯ | Supabaseï¼ˆBaaSï¼‰ |
| è®¤è¯ | Anonymous Auth |
| æ•°æ® | PostgreSQL + RLS |
| æœåŠ¡ç«¯é€»è¾‘ | Supabase Edge Functions |
| å®šæ—¶ä»»åŠ¡ | Supabase Cron Jobs |

### æ¶æ„åŸåˆ™

- å‰ç«¯å³å…¨æ ˆï¼ˆæ— è‡ªå»ºåç«¯æœåŠ¡ï¼‰
- å£°æ˜å¼ä¼˜å…ˆï¼ˆUI / SQL / æƒé™ï¼‰
- æ•°æ®åº“å³è§„åˆ™ä¸­å¿ƒï¼ˆRLSï¼‰
- æœ€å°ä¸Šä¸‹æ–‡ï¼Œæœ€å¤§ç¡®å®šæ€§ï¼ˆAI å‹å¥½ï¼‰

---

## äºŒã€ç›®å½•ç»“æ„

```text
died-or-not-scaffold/
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ DEPLOYMENT.md                # éƒ¨ç½²æŒ‡å—
â”œâ”€â”€ TESTING.md                   # æµ‹è¯•æŒ‡å—
â”œâ”€â”€ .env.example                 # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ deploy.sh                    # ä¸€é”®éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ supabase/
â”‚   â”œâ”€â”€ config.toml             # Supabase é…ç½®
â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â”œâ”€â”€ 001_init.sql        # è¡¨ç»“æ„
â”‚   â”‚   â”œâ”€â”€ 002_rls.sql         # è¡Œçº§å®‰å…¨ç­–ç•¥
â”‚   â”‚   â””â”€â”€ 003_cron_job.sql    # å®šæ—¶ä»»åŠ¡é…ç½®
â”‚   â”œâ”€â”€ setup-cron.sql          # Cron ä»»åŠ¡è®¾ç½®è„šæœ¬
â”‚   â””â”€â”€ functions/
â”‚       â”œâ”€â”€ check-missed-check-ins/
â”‚       â”‚   â”œâ”€â”€ index.ts        # å®šæ—¶æ‰«ææœªç­¾åˆ°ç”¨æˆ·
â”‚       â”‚   â””â”€â”€ deno.json       # Deno é…ç½®
â”‚       â””â”€â”€ send-notification-email/
â”‚           â”œâ”€â”€ index.ts        # å‘é€é€šçŸ¥
â”‚           â””â”€â”€ deno.json       # Deno é…ç½®
â”œâ”€â”€ ios/
â”‚   â””â”€â”€ DiedOrNot/
â”‚       â”œâ”€â”€ Package.swift        # Swift Package é…ç½®
â”‚       â”œâ”€â”€ Config.swift         # åº”ç”¨é…ç½®
â”‚       â”œâ”€â”€ App/
â”‚       â”‚   â””â”€â”€ DiedOrNotApp.swift
â”‚       â”œâ”€â”€ Services/
â”‚       â”‚   â””â”€â”€ SupabaseManager.swift  # Supabase å®¢æˆ·ç«¯ç®¡ç†
â”‚       â””â”€â”€ Views/
â”‚           â””â”€â”€ CheckInView.swift
â””â”€â”€ android/
    â””â”€â”€ app/src/main/java/com/diedornot/app/
        â”œâ”€â”€ MainActivity.kt      # åº”ç”¨å…¥å£
        â”œâ”€â”€ data/
        â”‚   â”œâ”€â”€ SupabaseClient.kt       # Supabase å®¢æˆ·ç«¯
        â”‚   â”œâ”€â”€ AuthService.kt          # è®¤è¯æœåŠ¡
        â”‚   â””â”€â”€ CheckInRepository.kt    # ç­¾åˆ°æ•°æ®æ“ä½œ
        â”œâ”€â”€ model/
        â”‚   â”œâ”€â”€ UserProfile.kt          # ç”¨æˆ·æ¨¡å‹
        â”‚   â””â”€â”€ CheckIn.kt              # ç­¾åˆ°æ¨¡å‹
        â””â”€â”€ ui/
            â”œâ”€â”€ CheckInScreen.kt        # ä¸»ç•Œé¢ (Compose)
            â””â”€â”€ CheckInViewModel.kt     # çŠ¶æ€ç®¡ç†
```

---

## ä¸‰ã€æ ¸å¿ƒèƒ½åŠ›è¯´æ˜

### 1. åŒ¿åè®¤è¯ï¼ˆAnonymous Authï¼‰

- App é¦–æ¬¡å¯åŠ¨å³åŒ¿åç™»å½•
- Supabase è‡ªåŠ¨ç”Ÿæˆ user_id
- æ— æ³¨å†Œ / æ— å¯†ç  / æ— æ„Ÿç»‘å®š
- æ•°æ®é€šè¿‡ RLS è‡ªåŠ¨éš”ç¦»

é€‚åˆ MVP / å•è®¾å¤‡åœºæ™¯ã€‚

---

### 2. æ•°æ®åº“å³è§„åˆ™

**é˜²é‡å¤ç­¾åˆ°**ï¼š

```sql
unique (user_id, check_in_date)
```

**æƒé™éš”ç¦»**ï¼š

```sql
auth.uid() = user_id
```

æ‰€æœ‰å®‰å…¨è§„åˆ™å‰ç§»è‡³æ•°æ®åº“å±‚ï¼Œ
é¿å… AI åœ¨ä¸šåŠ¡ä»£ç ä¸­åå¤å†™é”™æƒé™åˆ¤æ–­ã€‚

---

### 3. Edge Functions

#### check-missed-check-ins

- æ¯å¤©ç”± Cron è§¦å‘
- æ‰«ææ‰€æœ‰ç”¨æˆ·æœ€è¿‘ç­¾åˆ°æ—¶é—´
- è¿ç»­ 2 å¤©æœªç­¾åˆ° â†’ è§¦å‘é€šçŸ¥

#### send-notification-email

- æ¥æ”¶ç”¨æˆ·ä¿¡æ¯
- å‘é€é‚®ä»¶ / å¯æ‰©å±•çŸ­ä¿¡ã€å¾®ä¿¡ã€é’‰é’‰

æœåŠ¡ç«¯é€»è¾‘ **æå°‘ã€ç¡®å®šã€å¯æ›¿æ¢**ã€‚

---

## å››ã€å¿«é€Ÿå¼€å§‹

### æ–¹å¼ä¸€ï¼šæœ¬åœ°å¼€å‘ç¯å¢ƒ

#### 1. å®‰è£…ä¾èµ–

```bash
# å®‰è£… Supabase CLI
brew install supabase/tap/supabase

# å®‰è£… Denoï¼ˆç”¨äº Edge Functionsï¼‰
brew install deno
```

#### 2. å¯åŠ¨æœ¬åœ° Supabase

```bash
# å¯åŠ¨æœ¬åœ° Supabaseï¼ˆéœ€è¦ Dockerï¼‰
supabase start

# åº”ç”¨æ•°æ®åº“è¿ç§»
supabase db reset
```

#### 3. é…ç½®ç¯å¢ƒå˜é‡

```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å…¥ supabase start è¾“å‡ºçš„æœ¬åœ°å‡­è¯
```

#### 4. è¿è¡Œå®¢æˆ·ç«¯åº”ç”¨

**iOS:**
```bash
# ä½¿ç”¨ Xcode æ‰“å¼€é¡¹ç›®
open ios/DiedOrNot

# åœ¨ Config.swift ä¸­é…ç½®æœ¬åœ° URL
# ç„¶ååœ¨ Xcode ä¸­ Run
```

**Android:**
```bash
# é…ç½® Supabase å‡­è¯
# ç¼–è¾‘ android/gradle.propertiesï¼Œå¡«å…¥æœ¬åœ°å‡­è¯

# ä½¿ç”¨ Android Studio æ‰“å¼€
open android/

# æˆ–ä½¿ç”¨å‘½ä»¤è¡Œæ„å»º
cd android
./gradlew build
./gradlew installDebug
```

---

### æ–¹å¼äºŒï¼šä½¿ç”¨äº‘ç«¯ Supabase

#### 1. åˆ›å»º Supabase é¡¹ç›®

è®¿é—® [Supabase](https://supabase.com) åˆ›å»ºæ–°é¡¹ç›®

#### 2. ä¸€é”®éƒ¨ç½²

```bash
# ç™»å½• Supabase
supabase login

# å…³è”é¡¹ç›®
supabase link --project-ref <ä½ çš„é¡¹ç›®ID>

# ä¸€é”®éƒ¨ç½²
./deploy.sh
```

#### 3. é…ç½®å®šæ—¶ä»»åŠ¡

åœ¨ Supabase SQL Editor ä¸­æ‰§è¡Œ `supabase/setup-cron.sql`ï¼ˆæ›¿æ¢é¡¹ç›® URL å’Œå¯†é’¥ï¼‰

#### 4. é…ç½®å®¢æˆ·ç«¯åº”ç”¨

**iOS:** åœ¨ [Config.swift](ios/DiedOrNot/Config.swift) ä¸­å¡«å…¥ä½ çš„ Supabase URL å’Œ API Key

**Android:** åœ¨ [android/gradle.properties](android/gradle.properties) ä¸­å¡«å…¥ä½ çš„ Supabase URL å’Œ API Key

---

### è¯¦ç»†æ–‡æ¡£

- [éƒ¨ç½²æŒ‡å—](DEPLOYMENT.md) - å®Œæ•´çš„ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²è¯´æ˜
- [æµ‹è¯•æŒ‡å—](TESTING.md) - å„é¡¹åŠŸèƒ½çš„æµ‹è¯•æ–¹æ³•
- [Android è®¾ç½®æŒ‡å—](ANDROID_SETUP.md) - Android å®¢æˆ·ç«¯è¯¦ç»†è¯´æ˜
- [AI å¼€å‘æŒ‡å—](CLAUDE.md) - AI è¾…åŠ©å¼€å‘æœ€ä½³å®è·µ

---

## äº”ã€æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. å®¢æˆ·ç«¯åº”ç”¨

#### iOS (SwiftUI)
**SupabaseManagerï¼ˆæœåŠ¡å±‚ï¼‰**
- è‡ªåŠ¨åŒ¿åç™»å½•
- åˆ›å»ºç”¨æˆ·è®°å½•
- ç­¾åˆ°åŠŸèƒ½ï¼ˆé˜²é‡å¤ï¼‰
- æŸ¥è¯¢ç­¾åˆ°çŠ¶æ€

**CheckInViewï¼ˆè§†å›¾å±‚ï¼‰**
- å“åº”å¼ UI
- åŠ è½½çŠ¶æ€ç®¡ç†
- é”™è¯¯å¤„ç†å’Œå±•ç¤º
- ç”¨æˆ· ID æ˜¾ç¤º

#### Android (Jetpack Compose)
**æ•°æ®å±‚**
- `SupabaseClient`: Supabase å®¢æˆ·ç«¯å•ä¾‹
- `AuthService`: åŒ¿åè®¤è¯æœåŠ¡
- `CheckInRepository`: ç­¾åˆ°æ•°æ®æ“ä½œ

**UI å±‚**
- `CheckInScreen`: ä¸»ç•Œé¢ (Compose å£°æ˜å¼ UI)
- `CheckInViewModel`: çŠ¶æ€ç®¡ç† + ä¸šåŠ¡é€»è¾‘
- Material 3 è®¾è®¡ç³»ç»Ÿ

**è®¾è®¡å¯¹é½**
- Android â‰ˆ iOS æ¶æ„
- Compose â‰ˆ SwiftUI (å£°æ˜å¼)
- ViewModel â‰ˆ @StateObject (çŠ¶æ€ç®¡ç†)
- å…±äº«åŒä¸€ä¸ª Supabase åç«¯

### 2. Edge Functions

#### check-missed-check-ins
- æ‰«ææ‰€æœ‰ç”¨æˆ·æœ€åç­¾åˆ°æ—¶é—´
- è®¡ç®—è·ä»Šå¤©æ•°
- è¶…è¿‡ 2 å¤©è§¦å‘é€šçŸ¥
- è¿”å›è¯¦ç»†æ‰§è¡Œç»“æœ

#### send-notification-email
- æ¥æ”¶ç”¨æˆ·ä¿¡æ¯
- è®°å½•é€šçŸ¥æ—¥å¿—
- å¯æ‰©å±•é‚®ä»¶æœåŠ¡é›†æˆï¼ˆSendGrid / AWS SESï¼‰

### 3. æ•°æ®åº“è®¾è®¡

#### è¡¨ç»“æ„
- `users` - ç”¨æˆ·ä¿¡æ¯ï¼ˆid, name, emergency_emailï¼‰
- `check_ins` - ç­¾åˆ°è®°å½•ï¼ˆuser_id, check_in_dateï¼‰

#### å®‰å…¨ç­–ç•¥
- RLS è¡Œçº§å®‰å…¨ï¼šç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
- å”¯ä¸€çº¦æŸï¼šé˜²æ­¢åŒä¸€å¤©é‡å¤ç­¾åˆ°
- å¤–é”®çº¦æŸï¼šæ•°æ®å®Œæ•´æ€§ä¿è¯

---

## å…­ã€é€‚ç”¨åœºæ™¯

- AI å¿«é€Ÿè½åœ° MVP
- ä¸ªäºº / å°å›¢é˜Ÿ App
- å‰ç«¯ä¸»å¯¼çš„å…¨æ ˆåº”ç”¨
- æ— å¤æ‚åç«¯å·¥ç¨‹éœ€æ±‚
- å­¦ä¹  Supabase + SwiftUI å…¨æ ˆå¼€å‘

---

## ä¸ƒã€è®¾è®¡å“²å­¦

> AI ç¼–ç¨‹æ—¶ä»£ï¼Œ
> **æœ€é‡è¦çš„ä¸æ˜¯å†™å¤šå°‘ä»£ç ï¼Œè€Œæ˜¯è®¾è®¡å¤šå°‘"ä¸ä¼šè¢«å†™é”™çš„çº¦æŸ"ã€‚**

è¿™ä¸ªè„šæ‰‹æ¶çš„ç›®æ ‡æ˜¯ï¼š

- å‡å°‘åç«¯å·¥ç¨‹å¤æ‚åº¦
- å‹ç¼©ä¸Šä¸‹æ–‡è§„æ¨¡
- æé«˜ AI è¾“å‡ºçš„ç¡®å®šæ€§
- æ”¯æ’‘æŒç»­è¿­ä»£è€Œä¸è¿”å·¥

### AI å‹å¥½çš„è®¾è®¡åŸåˆ™

1. **å£°æ˜å¼ä¼˜å…ˆ** - SwiftUI / SQL / RLS éƒ½æ˜¯å£°æ˜å¼ï¼Œå‡å°‘è¿‡ç¨‹å¼ä»£ç 
2. **çº¦æŸå‰ç½®** - æ•°æ®åº“å±‚é¢çš„çº¦æŸï¼Œä¸ä¾èµ–ä¸šåŠ¡ä»£ç 
3. **æœ€å°æƒŠè®¶** - åŠŸèƒ½è¡Œä¸ºç¬¦åˆç›´è§‰ï¼Œå‡å°‘å¿ƒæ™ºè´Ÿæ‹…
4. **å¯è§‚æµ‹æ€§** - å®Œå–„çš„æ—¥å¿—å’Œé”™è¯¯ä¿¡æ¯

---

## å…«ã€æŠ€æœ¯äº®ç‚¹

### 1. æ— åç«¯æœåŠ¡å™¨
å®Œå…¨åŸºäº Supabase BaaSï¼Œæ— éœ€è‡ªå»ºåç«¯æœåŠ¡å™¨ã€æ— éœ€å®¹å™¨ç¼–æ’ã€æ— éœ€è´Ÿè½½å‡è¡¡ã€‚

### 2. è¡Œçº§å®‰å…¨ï¼ˆRLSï¼‰
æ•°æ®è®¿é—®æ§åˆ¶åœ¨æ•°æ®åº“å±‚é¢å®ç°ï¼Œå‰ç«¯ä»£ç æ— éœ€å…³å¿ƒæƒé™åˆ¤æ–­ã€‚

### 3. åŒ¿åè®¤è¯
ç”¨æˆ·æ— éœ€æ³¨å†Œå³å¯ä½¿ç”¨ï¼Œé™ä½ä½¿ç”¨é—¨æ§›ï¼Œé€‚åˆå¿«é€ŸéªŒè¯æƒ³æ³•ã€‚

### 4. Edge Functions
ä½¿ç”¨ Deno è¿è¡Œæ—¶ï¼Œæ¥è¿‘é›¶å†·å¯åŠ¨ï¼Œå…¨çƒåˆ†å¸ƒå¼éƒ¨ç½²ã€‚

### 5. å®šæ—¶ä»»åŠ¡
ä½¿ç”¨ PostgreSQL åŸç”Ÿ pg_cronï¼Œæ— éœ€é¢å¤–çš„ä»»åŠ¡è°ƒåº¦æœåŠ¡ã€‚

---

## ä¹ã€ä¸‹ä¸€æ­¥æ‰©å±•å»ºè®®

### åŠŸèƒ½æ‰©å±•
- [ ] æ·»åŠ ç”¨æˆ·èµ„æ–™ç¼–è¾‘åŠŸèƒ½
- [ ] é›†æˆçœŸå®é‚®ä»¶æœåŠ¡ï¼ˆSendGrid / AWS SES / Resendï¼‰
- [ ] æ·»åŠ æ¨é€é€šçŸ¥ï¼ˆAPNsï¼‰
- [ ] å®ç°ç­¾åˆ°å†å²æŸ¥çœ‹
- [ ] æ·»åŠ ç»Ÿè®¡å›¾è¡¨

### æŠ€æœ¯æ‰©å±•
- [ ] æ·»åŠ  Android åº”ç”¨ï¼ˆKotlin + Jetpack Composeï¼‰
- [ ] æ·»åŠ  Web åº”ç”¨ï¼ˆReact / Vue / Svelteï¼‰
- [ ] å®ç°è´¦å·å…³è”ï¼ˆä»åŒ¿åå‡çº§åˆ°æ­£å¼è´¦å·ï¼‰
- [ ] æ·»åŠ å•å…ƒæµ‹è¯•å’Œ E2E æµ‹è¯•
- [ ] æ€§èƒ½ç›‘æ§å’Œé”™è¯¯è¿½è¸ª

### AI å·¥ç¨‹æ‰©å±•
- [ ] æŠ½è±¡ä¸ºé€šç”¨ AI App Starter
- [ ] å°è£…æˆ CLIï¼ˆcreate-ai-appï¼‰
- [ ] å¢åŠ  Rules / Skills çº¦æŸ AI ç¼–ç 
- [ ] æä¾›æ›´å¤šåœºæ™¯æ¨¡æ¿

---

## åã€å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆé€‰æ‹© Supabase è€Œä¸æ˜¯ Firebaseï¼Ÿ
A: Supabase åŸºäº PostgreSQLï¼Œæ•°æ®æ¨¡å‹æ›´çµæ´»ï¼ŒRLS æ›´å¼ºå¤§ï¼Œä¸”å®Œå…¨å¼€æºã€‚

### Q: åŒ¿åè´¦å·ä¼šè¿‡æœŸå—ï¼Ÿ
A: é»˜è®¤ä¸ä¼šè¿‡æœŸï¼Œä½†å¯ä»¥åœ¨ Supabase æ§åˆ¶å°é…ç½®è¿‡æœŸç­–ç•¥ã€‚

### Q: å¯ä»¥è¿ç§»åˆ°è‡ªå·±çš„æœåŠ¡å™¨å—ï¼Ÿ
A: å¯ä»¥ï¼ŒSupabase æ˜¯å¼€æºçš„ï¼Œå¯ä»¥è‡ªæ‰˜ç®¡ã€‚

### Q: å¦‚ä½•æ‰©å±•åˆ°å¤šå¹³å°ï¼Ÿ
A: Supabase SDK æ”¯æŒå¤šå¹³å°ï¼ˆiOS / Android / Web / Flutterï¼‰ï¼Œå¯ä»¥å¤ç”¨åç«¯é€»è¾‘ã€‚

---

## åä¸€ã€å‚è€ƒèµ„æº

- [Supabase å®˜æ–¹æ–‡æ¡£](https://supabase.com/docs)
- [SwiftUI å®˜æ–¹æ•™ç¨‹](https://developer.apple.com/tutorials/swiftui)
- [Deno å®˜æ–¹æ–‡æ¡£](https://deno.land/manual)
- [PostgreSQL RLS æ–‡æ¡£](https://www.postgresql.org/docs/current/ddl-rowsecurity.html)

---

Happy hacking! ğŸš€

æœ‰é—®é¢˜æ¬¢è¿æ Issue æˆ– PRã€‚
